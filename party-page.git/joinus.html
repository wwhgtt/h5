<!DOCTYPE>
<html>
	<head>
		<title>益驾科技请你"出名"</title>
		<meta charset="utf-8"/>
		<meta Content-Type="application/x-www-form-urlencoded" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
		<link rel="stylesheet" type="text/css" href="./css/style.css">
		<script src="./js/lib/zetpo.min.js"></script>
		<!-- // <script src="./js/lib/jquery.min.js"></script> -->
		<script src="./js/script/main.js"></script>
		<script src="./js/script/config.js"></script>
		<script src="./js/lib/inobounce.min.js"></script>

	</head>
	<body>
		<div class="background_img">
			<img src="./img/joinus.png">
		</div>
		<div class="nameForm">
			<div class="nameInput">
				<div class="nameDetile">
					<img src="./img/input.png" class="name_input">
					<input tyep="text" palceholder="输入想好的名称" class="think_input"  style="height:30px"/>
					<img src="./img/more.png" class="moreName" title="1" />
				</div>
			</div>
		</div>
		<img src="./img/submit.png" class="submit_name" onclick="submit()">
		<div class="modelBlock">
			<div class="keepMessage">
				<img src="./img/complete.png" class="ruleBack">
				<img src="./img/close.png" class="close" onclick="closeRule()">
				<div class="ruleDetile" style="top:10%">
					<lable>输入您的大名</lable>
					<img  src="./img/contact.png" class="contact" />
					<input type="text" plaseholder="输入您的大名" class="wholeName" >
					<br>
					<lable class="phoneLable">留下您的电话</lable>
					 <img  src="./img/contact.png" class="contact_phone" />
					<input type="text" plaseholder="留下您的电话" class="phone">
					<img src="./img/docom.png" class="docom" >
					<!-- <button   class="submitButton">确认提交</button> -->
				</div>
			</div>
		</div>
		<div class="modelBlock_rank">
			<img src="./img/thanks.png" class="thanks">
			<a href="/?openRank=1"><img src="./img/lookRank.png" class="lookRank"></a>
			<img src="./img/share.png" class="share" onclick="showArrow()">
			<img src="./img/shareArrow.png" class="shareArrow" >
		</div>
	</body>
</html>
<script type="text/javascript">
	var html='<div class="nameDetile">\
				<img src="./img/input.png" class="name_input">\
				<input tyep="text" palceholder="输入想好的名称" class="think_input"  style="height:30px"/>\
				<img src="./img/more.png" class="moreName" title="1"/>\
			</div>';
	$(".nameInput").on("click",".moreName",function(){
		var title=$(this).attr("title");
		if(title == 1){
			$(".nameInput").append(html);
			$(this).attr("src","./img/delete.png");
			$(this).attr("title","2");
		}else{
			$(this).parent().remove();
		}
	});
	
	function submit(){
		$(".modelBlock").css("display","block");
	}
	var array=[];
	$(".docom").on("click",function(){
		var nameList = "";
		$(".think_input").each(function(){
			var name=$(this).val();
			if(name !== ""){
				nameList += name + ",";
				// nameList.push(name);
			}
		});
		if($(".wholeName").val() !== "" && $(".phone").val()!== "" && nameList.length){
			$.ajax({
				url:BASE_URL + "/getname/putname.do",
				type:"POST",
				dataType:"json",
				data:{
					name:nameList,
					username:$(".wholeName").val(),
					phonenum:$(".phone").val()
				},
				success:function(result){
					var overname=result.overname;
					var resultcode=result.resultcode;
					if(resultcode == "0"){
						if(overname == ""){
							$(".modelBlock").css("display","none");
							$(".modelBlock_rank").css("display","block");
						}else{
							alert(overname+"重复提交或有人已提交过")
						}
					}else{
						alert("提交失败")
					}
				}
			})
		}
	})
	$('.wholeName').blur(function(){
	 	var $parent = $(this).parent();
	 	var value=$(this).val();
	 	if(this.value==""){
	 		var errorMsg = '请输入您的大名';
            $parent.append('<small class="onError">'+'*'+errorMsg+'</small>');
	 	}
	}).keyup(function(){
       $(this).triggerHandler("blur");
    });

	$('.phone').blur(function(){
	 	var $parent = $(this).parent();
	 	var value=$(this).val();
	 	if(this.value==""){
	 		var errorMsg = '留下您的电话';
            $parent.append('<small class="formtips">'+'*'+errorMsg+'</small>');
	 	}
	}).keyup(function(){
        $(this).triggerHandler("blur");
    });
	function closeRule(){
		$(".modelBlock").css("display","none");
	}
	function showArrow(){
		// $(".shareArrow").css("display","block")
		localStorage.setItem("showArrow","1");
		location.href = "/?showArrow=1"
	}
	localStorage.setItem("showArrow","0");
</script>